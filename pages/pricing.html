<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Pricing - Vixvvo Tools</title>
<link rel="icon" type="image/png" href="../images/favicon.png">

<!-- ========================================
     FIREBASE SDKs - REQUIRED
     ======================================== -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-functions-compat.js"></script>

<!-- ========================================
     FONTS
     ======================================== -->
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

<!-- ========================================
     SHARED STYLES - REQUIRED
     ======================================== -->
<link rel="stylesheet" href="../css/shared-styles.css">

<!-- ========================================
     NAVBAR SYSTEM - REQUIRED
     ======================================== -->
<script src="../js/navbar-helper.js"></script>
<script src="../js/navbar-loader.js"></script>
<script src="../js/settings-dropdown.js"></script>
<script src="../js/navbar-auth.js"></script>
<script src="../js/auth.js"></script>
<script src="../js/membership.js"></script>
<script src="../js/navigation.js"></script>

<style>
  /* ========================================
     PAGE STYLES
     ======================================== */
  
  * {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  html {
    scroll-behavior: smooth;
  }

  body {
    min-height: 100vh;
  }

  .page-container {
    max-width: 1300px;
    margin: 0 auto;
    padding: 20px 40px 80px;
  }
  
  .page-header {
    text-align: center;
    margin-bottom: 60px;
    padding-top: 60px;
  }
  
  .page-title {
    font-size: 64px;
    font-weight: 900;
    margin-bottom: 20px;
    letter-spacing: -1px;
    line-height: 1.1;
  }
  
  .page-title .highlight {
    background: linear-gradient(135deg, #a855f7, #c084fc, #e879f9);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
  
  .page-subtitle {
    color: var(--text-muted);
    font-size: 18px;
    max-width: 600px;
    margin: 0 auto;
    line-height: 1.7;
  }

  /* Billing Toggle */
  .billing-toggle {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    gap: 12px;
    margin-bottom: 40px;
  }

  .billing-toggle-buttons {
    display: inline-flex;
    background: var(--card-bg);
    border: 1px solid rgba(168, 85, 247, 0.2);
    border-radius: 50px;
    padding: 6px;
    gap: 6px;
  }

  .billing-toggle-btn {
    padding: 12px 32px;
    border: none;
    background: transparent;
    color: var(--text-muted);
    font-size: 15px;
    font-weight: 600;
    border-radius: 50px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-family: 'Inter', sans-serif;
  }

  .billing-toggle-btn:hover {
    color: var(--text);
  }

  .billing-toggle-btn.active {
    background: linear-gradient(135deg, var(--purple), var(--purple-light));
    color: white;
    box-shadow: 0 4px 12px rgba(168, 85, 247, 0.3);
  }

  .save-badge {
    display: inline-block;
    padding: 8px 16px;
    background: linear-gradient(135deg, #10b981, #059669);
    color: white;
    font-size: 13px;
    font-weight: 700;
    border-radius: 20px;
    letter-spacing: 0.5px;
    box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
  }

  /* Price amount animation */
  .price .amount {
    transition: all 0.3s ease;
    display: inline-block;
  }

  /* Pricing Grid */
  .pricing-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 20px;
    margin-bottom: 80px;
  }

  .pricing-card {
    background: var(--card-bg);
    border: 1px solid rgba(168, 85, 247, 0.2);
    border-radius: 20px;
    padding: 36px 28px;
    transition: transform .3s ease, box-shadow .3s ease, border-color .3s ease;
    position: relative;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    will-change: transform;
  }

  .pricing-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, transparent, var(--purple), transparent);
    opacity: 0;
    transition: opacity .3s;
  }

  .pricing-card:hover::before {
    opacity: 1;
  }

  .pricing-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 15px 35px rgba(168, 85, 247, .15);
    border-color: rgba(168, 85, 247, 0.5);
  }

  .pricing-card.featured {
    border: 2px solid var(--purple);
    background: var(--card-bg);
    box-shadow: 0 10px 30px rgba(168, 85, 247, .2);
    transform: scale(1.03);
  }

  .pricing-card.featured::before {
    opacity: 1;
    background: linear-gradient(90deg, var(--purple), var(--purple-light), var(--purple));
  }

  .pricing-card.featured:hover {
    transform: scale(1.03) translateY(-8px);
    box-shadow: 0 20px 40px rgba(168, 85, 247, .25);
  }

  .pricing-card.current-tier {
    border: 2px solid #f59e0b;
    background: linear-gradient(135deg, rgba(245, 158, 11, 0.05), rgba(217, 119, 6, 0.03));
    box-shadow: 0 10px 30px rgba(245, 158, 11, .2);
  }

  .pricing-card.current-tier::before {
    opacity: 1;
    background: linear-gradient(90deg, #f59e0b, #d97706, #f59e0b);
  }

  .pricing-card.current-tier .plan-badge {
    background: linear-gradient(135deg, #f59e0b, #d97706);
    color: white;
    border: none;
    box-shadow: 0 4px 12px rgba(245, 158, 11, .3);
  }

  .pricing-card.current-tier .plan-badge::after {
    content: ' • Current Plan';
    font-size: 10px;
    margin-left: 4px;
  }

  .plan-badge {
    display: inline-block;
    padding: 8px 16px;
    background: rgba(168, 85, 247, .12);
    border: 1px solid rgba(168, 85, 247, .3);
    border-radius: 25px;
    font-size: 11px;
    font-weight: 700;
    color: var(--purple);
    margin-bottom: 24px;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    align-self: flex-start;
  }

  .plan-badge.popular {
    background: linear-gradient(135deg, var(--purple), var(--purple-light));
    color: white;
    border: none;
    box-shadow: 0 4px 12px rgba(168, 85, 247, .3);
  }

  .pricing-card h3 {
    font-size: 32px;
    margin-bottom: 12px;
    font-weight: 800;
    letter-spacing: -0.5px;
  }

  .price {
    margin-bottom: 28px;
    padding-bottom: 28px;
    border-bottom: 1px solid rgba(255,255,255,.08);
  }

  .price .amount {
    font-size: 56px;
    font-weight: 900;
    background: linear-gradient(135deg, #a855f7, #c084fc);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    letter-spacing: -2px;
  }

  .price .period {
    font-size: 15px;
    color: var(--text-muted);
    font-weight: 500;
  }

  .features-list {
    list-style: none;
    margin-bottom: 32px;
    flex-grow: 1;
  }

  .features-list li {
    padding: 14px 0;
    color: var(--text-muted);
    font-size: 14px;
    line-height: 1.5;
    display: flex;
    align-items: flex-start;
    gap: 10px;
  }

  .features-list li::before {
    content: attr(data-icon);
    flex-shrink: 0;
    font-size: 16px;
    width: 20px;
    height: 20px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    font-weight: 900;
  }

  .features-list li[data-icon="✓"]::before {
    background: rgba(16, 185, 129, 0.15);
    color: #10b981;
    border: 1px solid rgba(16, 185, 129, 0.3);
  }

  .features-list li[data-icon="✗"]::before {
    background: rgba(239, 68, 68, 0.15);
    color: #ef4444;
    border: 1px solid rgba(239, 68, 68, 0.3);
    opacity: 0.6;
  }

  .features-list li[data-icon="✗"] {
    opacity: 0.5;
  }

  .pricing-card .btn {
    width: 100%;
    padding: 18px;
    font-size: 15px;
    font-weight: 700;
    border-radius: 12px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    transition: all .3s;
  }

  .pricing-card .btn {
    will-change: transform;
  }

  .pricing-card .btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(168, 85, 247, .25);
  }

  .pricing-card.featured .btn-primary {
    background: linear-gradient(135deg, var(--purple), var(--purple-light));
    box-shadow: 0 6px 18px rgba(168, 85, 247, .3);
  }

  /* FAQ Section */
  .faq-section {
    margin-top: 100px;
    max-width: 900px;
    margin-left: auto;
    margin-right: auto;
  }

  .faq-title {
    font-size: 42px;
    font-weight: 800;
    text-align: center;
    margin-bottom: 56px;
    letter-spacing: -0.5px;
  }

  .faq-item {
    background: var(--card-bg);
    border: 1px solid rgba(168, 85, 247, 0.15);
    border-radius: 16px;
    padding: 28px 32px;
    margin-bottom: 20px;
    transition: border-color .3s ease, background .3s ease;
  }

  .faq-item:hover {
    border-color: rgba(168, 85, 247, 0.4);
    background: rgba(36, 29, 53, 0.5);
  }

  .faq-question {
    font-size: 19px;
    font-weight: 700;
    margin-bottom: 14px;
    color: var(--text);
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .faq-answer {
    font-size: 15px;
    color: var(--text-muted);
    line-height: 1.7;
  }

  /* CTA Section */
  .cta-section {
    text-align: center;
    margin-top: 100px;
    padding: 70px 50px;
    background: linear-gradient(135deg, rgba(168, 85, 247, .08), rgba(192, 132, 252, .05));
    border: 2px solid rgba(168, 85, 247, .3);
    border-radius: 20px;
    position: relative;
    overflow: hidden;
  }

  .cta-section::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(circle, rgba(168, 85, 247, .05) 0%, transparent 70%);
    opacity: 0.5;
    pointer-events: none;
  }

  .cta-section > * {
    position: relative;
    z-index: 1;
  }

  .cta-title {
    font-size: 40px;
    font-weight: 900;
    margin-bottom: 18px;
    letter-spacing: -0.5px;
  }

  .cta-text {
    font-size: 17px;
    color: var(--text-muted);
    margin-bottom: 36px;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
  }

  /* Responsive */
  @media (max-width: 1200px) {
    .pricing-grid {
      grid-template-columns: repeat(2, 1fr);
      gap: 24px;
    }

    .pricing-card.featured {
      transform: scale(1);
      grid-column: span 2;
      max-width: 500px;
      margin: 0 auto;
      width: 100%;
    }

    .pricing-card.featured:hover {
      transform: translateY(-12px);
    }
  }

  @media (max-width: 768px) {
    .page-container {
      padding: 15px 20px 60px;
    }

    .page-header {
      margin-bottom: 40px;
      padding-top: 30px;
    }

    .page-title {
      font-size: 40px;
    }

    .page-subtitle {
      font-size: 16px;
    }

    .pricing-grid {
      grid-template-columns: 1fr;
      gap: 20px;
    }

    .pricing-card.featured {
      grid-column: span 1;
      max-width: 100%;
    }

    .pricing-card {
      padding: 32px 24px;
    }

    .price .amount {
      font-size: 48px;
    }

    .faq-section {
      margin-top: 70px;
    }

    .faq-title {
      font-size: 32px;
    }

    .faq-item {
      padding: 24px;
    }

    .faq-question {
      font-size: 17px;
    }

    .cta-section {
      padding: 50px 28px;
      margin-top: 70px;
    }

    .cta-title {
      font-size: 30px;
    }

    .cta-text {
      font-size: 16px;
    }
  }

  @media (max-width: 480px) {
    .page-title {
      font-size: 34px;
    }

    .price .amount {
      font-size: 42px;
    }

    .pricing-card h3 {
      font-size: 26px;
    }
  }

  /* Notification Styles */
  .notification {
    position: fixed;
    top: 24px;
    right: 24px;
    transform: translateX(400px);
    background: #1e172e;
    border: 1px solid rgba(168, 85, 247, 0.3);
    border-radius: 12px;
    padding: 20px 24px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4), 0 0 0 1px rgba(168, 85, 247, 0.1);
    z-index: 9999;
    min-width: 320px;
    max-width: 420px;
    opacity: 0;
    pointer-events: none;
    transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    display: flex;
    align-items: center;
    gap: 16px;
  }

  .notification.show {
    opacity: 1;
    transform: translateX(0);
    pointer-events: all;
  }

  .notification-icon {
    font-size: 28px;
    min-width: 28px;
    text-align: center;
    filter: drop-shadow(0 0 8px currentColor);
  }

  .notification-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 4px;
  }

  .notification-title {
    font-size: 16px;
    font-weight: 600;
    color: #f3f4f6;
    line-height: 1.3;
  }

  .notification-message {
    font-size: 14px;
    color: #9ca3af;
    line-height: 1.4;
  }

  .notification-close {
    background: none;
    border: none;
    color: #9ca3af;
    font-size: 20px;
    cursor: pointer;
    padding: 4px 8px;
    border-radius: 6px;
    transition: all 0.2s ease;
    line-height: 1;
    opacity: 0.6;
  }

  .notification-close:hover {
    background: rgba(255, 255, 255, 0.05);
    color: #f3f4f6;
    opacity: 1;
  }

  /* Success variant */
  .notification.success {
    border-color: rgba(16, 185, 129, 0.4);
    background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(30, 23, 46, 0.95) 50%);
  }

  .notification.success .notification-icon {
    color: #10b981;
  }

  /* Error variant */
  .notification.error {
    border-color: rgba(239, 68, 68, 0.4);
    background: linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(30, 23, 46, 0.95) 50%);
  }

  .notification.error .notification-icon {
    color: #ef4444;
  }

  /* Warning variant */
  .notification.warning {
    border-color: rgba(245, 158, 11, 0.4);
    background: linear-gradient(135deg, rgba(245, 158, 11, 0.1) 0%, rgba(30, 23, 46, 0.95) 50%);
  }

  .notification.warning .notification-icon {
    color: #f59e0b;
  }

  /* Progress bar animation */
  .notification::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    height: 3px;
    background: linear-gradient(90deg, #a855f7, #c084fc);
    border-radius: 0 0 12px 12px;
    animation: notificationProgress 3s linear forwards;
  }

  .notification.success::after {
    background: linear-gradient(90deg, #10b981, #34d399);
  }

  .notification.error::after {
    background: linear-gradient(90deg, #ef4444, #f87171);
  }

  .notification.warning::after {
    background: linear-gradient(90deg, #f59e0b, #fbbf24);
  }

  @keyframes notificationProgress {
    from {
      width: 100%;
    }
    to {
      width: 0%;
    }
  }

  /* Mobile responsive */
  @media (max-width: 768px) {
    .notification {
      top: 12px;
      right: 12px;
      left: 12px;
      min-width: auto;
      max-width: none;
    }
  }
</style>
</head>
<body>
  <!-- Loading Overlay -->
  <div id="loadingOverlay" style="
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: var(--dark-bg);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 10000;
    transition: opacity 0.3s ease;
  ">
    <div style="
      width: 60px;
      height: 60px;
      border: 4px solid var(--border);
      border-top: 4px solid var(--purple);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    "></div>
    <p style="margin-top: 20px; color: var(--text-muted); font-size: 14px;">Loading pricing...</p>
    <style>
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
    </style>
  </div>

  <!-- Navbar Container -->
  <div id="navbar-container"></div>
  
  <!-- Page Content -->
  <div class="page-container">
    <div class="page-header">
      <h1 class="page-title">Choose Your <span class="highlight">Plan</span></h1>
      <p class="page-subtitle">Unlock premium features and support our development with flexible pricing that scales with your needs</p>
    </div>
    
    <!-- Billing Toggle -->
    <div class="billing-toggle">
      <div class="billing-toggle-buttons">
        <button class="billing-toggle-btn" data-period="monthly">Monthly</button>
        <button class="billing-toggle-btn active" data-period="annual">Annual</button>
      </div>
      <span class="save-badge">Save 25% with Annual</span>
    </div>
    
    <!-- Pricing Grid -->
    <div class="pricing-grid">
      <div class="pricing-card" data-tier="free">
        <div class="plan-badge">Free</div>
        <h3>Free</h3>
        <div class="price">
          <span class="amount" data-monthly="0" data-annual="0">$0</span>
          <span class="period">/forever</span>
        </div>
        <ul class="features-list">
          <li data-icon="✓">Full calculator access</li>
          <li data-icon="✓">Save calculations</li>
          <li data-icon="✓">Basic printer management</li>
          <li data-icon="✓">Public view of printers</li>
          <li data-icon="✗">Community support only</li>
          <li data-icon="✗">Standard features</li>
        </ul>
        <button class="btn btn-outline" onclick="window.location.href='../index.html'">Get Started</button>
      </div>
      
      <div class="pricing-card" data-tier="starter">
        <div class="plan-badge">Tier 1</div>
        <h3>Starter</h3>
        <div class="price">
          <span class="amount" data-monthly="3" data-annual="2.25">$3</span>
          <span class="period">/month</span>
        </div>
        <ul class="features-list">
          <li data-icon="✓">Everything in Free</li>
          <li data-icon="✓">Priority support</li>
          <li data-icon="✓">Advanced analytics</li>
          <li data-icon="✓">Export to PDF</li>
          <li data-icon="✓">Remove ads</li>
          <li data-icon="✓">Starter badge</li>
        </ul>
        <button class="btn btn-outline" 
          data-monthly-url="https://www.patreon.com/checkout/Vixvvo3D?rid=27090437&_rsc=1kxfk" 
          data-annual-url="https://www.patreon.com/checkout/Vixvvo3D?rid=27090437&cadence=12&is_free_trial=false">Subscribe on Patreon</button>
      </div>
      
      <div class="pricing-card featured" data-tier="scaling">
        <div class="plan-badge popular">Most Popular</div>
        <h3>Scaling</h3>
        <div class="price">
          <span class="amount" data-monthly="10" data-annual="7.50">$10</span>
          <span class="period">/month</span>
        </div>
        <ul class="features-list">
          <li data-icon="✓">Everything in Starter</li>
          <li data-icon="✓">Custom branding</li>
          <li data-icon="✓">Early access to features</li>
          <li data-icon="✓">Advanced presets</li>
          <li data-icon="✓">Priority feature requests</li>
          <li data-icon="✓">Scaling badge</li>
        </ul>
        <button class="btn btn-primary" 
          data-monthly-url="https://www.patreon.com/checkout/Vixvvo3D?rid=22702418" 
          data-annual-url="https://www.patreon.com/checkout/Vixvvo3D?rid=22702418&cadence=12&is_free_trial=false">Subscribe on Patreon</button>
      </div>
      
      <div class="pricing-card" data-tier="business">
        <div class="plan-badge">Premium</div>
        <h3>Business</h3>
        <div class="price">
          <span class="amount" data-monthly="25" data-annual="18.75">$25</span>
          <span class="period">/month</span>
        </div>
        <ul class="features-list">
          <li data-icon="✓">Everything in Scaling</li>
          <li data-icon="✓">API access</li>
          <li data-icon="✓">White-label solution</li>
          <li data-icon="✓">Custom integrations</li>
          <li data-icon="✓">Dedicated support</li>
          <li data-icon="✓">Business badge</li>
        </ul>
        <button class="btn btn-outline" 
          data-monthly-url="https://www.patreon.com/checkout/Vixvvo3D?rid=27090435&cadence=1&is_free_trial=false" 
          data-annual-url="https://www.patreon.com/checkout/Vixvvo3D?rid=27090435&cadence=12&is_free_trial=false">Subscribe on Patreon</button>
      </div>
    </div>

    <!-- FAQ Section -->
    <div class="faq-section">
      <h2 class="faq-title">Frequently Asked Questions</h2>
      
      <div class="faq-item">
        <div class="faq-question">❓ How does the Patreon integration work?</div>
        <div class="faq-answer">Once you subscribe on Patreon, simply link your Patreon account in your profile settings. Your membership tier will automatically sync and unlock all the features for your tier!</div>
      </div>

      <div class="faq-item">
        <div class="faq-question">💳 Can I change my plan anytime?</div>
        <div class="faq-answer">Yes! You can upgrade, downgrade, or cancel your Patreon subscription anytime. Your access level will update automatically on our website.</div>
      </div>

      <div class="faq-item">
        <div class="faq-question">🔄 What happens if I cancel?</div>
        <div class="faq-answer">If you cancel your Patreon subscription, you'll retain access until the end of your billing period, then your account will revert to the Free tier.</div>
      </div>

      <div class="faq-item">
        <div class="faq-question">💼 Do you offer team plans?</div>
        <div class="faq-answer">The Business tier is perfect for teams! Contact us for custom enterprise solutions with dedicated support and custom integrations.</div>
      </div>

      <div class="faq-item">
        <div class="faq-question">🆓 Is the free tier really free forever?</div>
        <div class="faq-answer">Absolutely! The Free tier will always be available with core features. No credit card required, no time limits.</div>
      </div>
    </div>

    <!-- CTA Section -->
    <div class="cta-section">
      <h2 class="cta-title">🎉 Ready to Get Started?</h2>
      <p class="cta-text">Join thousands of makers using Vixvvo to streamline their 3D printing workflow</p>
      <div style="display: flex; gap: 16px; justify-content: center; flex-wrap: wrap;">
        <button class="btn btn-primary" onclick="window.location.href='../index.html'">Start for Free</button>
        <button class="btn btn-outline" onclick="window.location.href='patreon-link.html'">Manage Membership</button>
      </div>
    </div>
  </div>

  <!-- Overlay -->
  <div id="overlay"></div>

  <!-- Notification Dialog -->
  <div id="customNotification" class="notification">
    <div class="notification-icon">✓</div>
    <div class="notification-content">
      <div class="notification-title">Success!</div>
      <div class="notification-message"></div>
    </div>
    <button class="notification-close" onclick="hideNotification()">×</button>
  </div>

  <!-- JavaScript -->
  <script>
    // Notification System
    function showNotification(message, type = 'success', title = '') {
      const notification = document.getElementById('customNotification');
      
      // Remove previous type classes
      notification.classList.remove('success', 'error', 'warning');
      
      // Set icon and title based on type
      let icon = '✓';
      let notificationTitle = title || 'Success!';
      
      if (type === 'error') {
        icon = '✕';
        notificationTitle = title || 'Error';
      } else if (type === 'warning') {
        icon = '⚠';
        notificationTitle = title || 'Warning';
      }
      
      // Update content
      notification.querySelector('.notification-icon').textContent = icon;
      notification.querySelector('.notification-title').textContent = notificationTitle;
      notification.querySelector('.notification-message').textContent = message;
      
      // Add type class and show
      notification.classList.add(type);
      notification.classList.add('show');
      
      // Auto-hide after 3 seconds
      setTimeout(() => {
        hideNotification();
      }, 3000);
    }

    function hideNotification() {
      const notification = document.getElementById('customNotification');
      notification.classList.remove('show');
    }

    // Billing Period Handling
    let currentBillingPeriod = 'annual';

    // Update all pricing amounts based on billing period
    function updatePricingDisplay() {
      document.querySelectorAll('.price .amount').forEach(element => {
        const monthlyPrice = parseFloat(element.getAttribute('data-monthly'));
        const annualPrice = parseFloat(element.getAttribute('data-annual'));
        
        // Add animation class
        element.style.transform = 'scale(0.9)';
        element.style.opacity = '0.5';
        
        setTimeout(() => {
          if (currentBillingPeriod === 'annual') {
            if (annualPrice === 0) {
              element.textContent = '$0';
            } else {
              element.textContent = '$' + annualPrice.toFixed(2).replace('.00', '');
            }
          } else {
            if (monthlyPrice === 0) {
              element.textContent = '$0';
            } else {
              element.textContent = '$' + monthlyPrice.toFixed(0);
            }
          }
          
          // Reset animation
          element.style.transform = 'scale(1)';
          element.style.opacity = '1';
        }, 150);
      });
      
      // Update button URLs
      document.querySelectorAll('.pricing-card .btn[data-monthly-url]').forEach(button => {
        const monthlyUrl = button.getAttribute('data-monthly-url');
        const annualUrl = button.getAttribute('data-annual-url');
        const card = button.closest('.pricing-card');
        
        // Remove old onclick handler
        button.onclick = null;
        
        // Don't add click handler if it's the current tier
        if (card && card.classList.contains('current-tier')) {
          button.onclick = function(e) { e.preventDefault(); return false; };
          return;
        }
        
        // Set new onclick handler based on billing period
        if (currentBillingPeriod === 'annual' && annualUrl) {
          button.onclick = function() { window.open(annualUrl, '_blank'); };
        } else if (monthlyUrl) {
          button.onclick = function() { window.open(monthlyUrl, '_blank'); };
        }
      });
    }

    // Initialize billing toggle
    document.addEventListener('DOMContentLoaded', function() {
      const toggleButtons = document.querySelectorAll('.billing-toggle-btn');
      
      // Set initial pricing to annual
      updatePricingDisplay();
      
      toggleButtons.forEach(button => {
        button.addEventListener('click', function() {
          // Remove active class from all buttons
          toggleButtons.forEach(btn => btn.classList.remove('active'));
          // Add active class to clicked button
          this.classList.add('active');
          
          // Update billing period
          currentBillingPeriod = this.getAttribute('data-period');
          updatePricingDisplay();
        });
      });
    });

    function updateSaveButton() {
      const user = firebase.auth().currentUser;
      const currencySelect = document.getElementById('currencySelect');
      const btnSaveCurrency = document.getElementById('btnSaveCurrency');
      
      if (!currencySelect || !btnSaveCurrency) return;
      
      if (user) {
        btnSaveCurrency.style.display = 'block';
        
        if (currencySelect.value !== window.lastSavedCurrency) {
          btnSaveCurrency.textContent = 'Save';
          btnSaveCurrency.disabled = false;
          btnSaveCurrency.style.opacity = '1';
        } else {
          btnSaveCurrency.textContent = 'Saved';
          btnSaveCurrency.disabled = true;
          btnSaveCurrency.style.opacity = '0.5';
        }
      } else {
        btnSaveCurrency.style.display = 'none';
      }
    }

    function saveCurrencyPreference() {
      const user = firebase.auth().currentUser;
      const currencySelect = document.getElementById('currencySelect');
      const btnSaveCurrency = document.getElementById('btnSaveCurrency');
      
      if (!user) {
        showNotification('Please login to save your currency preference', 'warning', 'Login Required');
        return;
      }
      
      window.currentCurrency = currencySelect.value;
      btnSaveCurrency.disabled = true;
      btnSaveCurrency.textContent = 'Saving...';
      
      firebase.database().ref('users/' + user.uid + '/currency').set(window.currentCurrency)
        .then(() => {
          window.lastSavedCurrency = window.currentCurrency;
          btnSaveCurrency.textContent = 'Saved';
          showNotification('Currency preference saved! Reloading page...', 'success');
          
          // Reload page after 1.5 seconds
          setTimeout(() => {
            window.location.reload();
          }, 1500);
        })
        .catch(error => {
          console.error('Error saving currency:', error);
          btnSaveCurrency.textContent = 'Error';
          showNotification('Failed to save currency. Please try again.', 'error', 'Error');
          
          setTimeout(() => {
            updateSaveButton();
          }, 3000);
        });
    }

    function loadSavedCurrency(user) {
      if (!user) return;
      
      firebase.database().ref('users/' + user.uid + '/currency').once('value')
        .then(snapshot => {
          const savedCurrency = snapshot.val();
          if (savedCurrency) {
            window.currentCurrency = savedCurrency;
            window.lastSavedCurrency = savedCurrency;
            
            const currencySelect = document.getElementById('currencySelect');
            if (currencySelect) {
              currencySelect.value = savedCurrency;
            }
            updateSaveButton();
          }
        })
        .catch(error => {
          console.error('Error loading currency:', error);
        });
    }

    // Navbar Button Handlers
    document.addEventListener('navbarLoaded', function() {
      const btnLoginNav = document.getElementById('btnLoginNav');
      const btnLoginSettings = document.getElementById('btnLoginSettings');
      const btnLogoutSettings = document.getElementById('btnLogoutSettings');
      const currencySelect = document.getElementById('currencySelect');
      const btnSaveCurrency = document.getElementById('btnSaveCurrency');

      if (btnLoginNav) {
        btnLoginNav.addEventListener('click', () => {
          window.location.href = '../index.html?login=true';
        });
      }

      if (btnLoginSettings) {
        btnLoginSettings.addEventListener('click', () => {
          window.location.href = '../index.html?login=true';
        });
      }

      if (btnLogoutSettings) {
        btnLogoutSettings.addEventListener('click', () => {
          firebase.auth().signOut().then(() => {
            showNotification('You have been logged out successfully.', '', 'Goodbye!');
            setTimeout(() => {
              window.location.reload();
            }, 1500);
          });
        });
      }

      if (currencySelect) {
        currencySelect.addEventListener('change', function() {
          window.currentCurrency = this.value;
          updateSaveButton();
        });
      }

      if (btnSaveCurrency) {
        btnSaveCurrency.addEventListener('click', saveCurrencyPreference);
      }

      firebase.auth().onAuthStateChanged(async (user) => {
        if (user) {
          loadSavedCurrency(user);
          
          // Highlight current tier
          try {
            // Check if user is admin first
            const roleSnapshot = await firebase.database().ref(`users/${user.uid}/role`).once('value');
            const role = roleSnapshot.val();
            const isAdmin = role === 'admin' || role === 'administrator';
            
            // Only highlight tier if not admin
            if (!isAdmin) {
              const tierSnapshot = await firebase.database().ref(`users/${user.uid}/membership/tier`).once('value');
              const userTier = tierSnapshot.val() || 'free';
              
              // Define tier hierarchy for comparison
              const tierLevels = { free: 0, starter: 1, scaling: 2, business: 3 };
              const userTierLevel = tierLevels[userTier] || 0;
              
              // Remove current-tier class from all cards
              document.querySelectorAll('.pricing-card').forEach(card => {
                card.classList.remove('current-tier');
                const btn = card.querySelector('.btn');
                if (btn) {
                  btn.classList.remove('upgrade', 'downgrade');
                }
              });
              
              // Add current-tier class to user's tier card and update button text
              document.querySelectorAll('.pricing-card').forEach(card => {
                const cardTier = card.getAttribute('data-tier');
                const cardTierLevel = tierLevels[cardTier] || 0;
                const btn = card.querySelector('.btn');
                
                if (cardTier === userTier) {
                  card.classList.add('current-tier');
                  if (btn) {
                    btn.setAttribute('data-original-text', btn.textContent);
                    btn.textContent = 'Current Plan';
                    btn.style.cursor = 'default';
                    btn.style.opacity = '0.7';
                    btn.onclick = function(e) { e.preventDefault(); return false; };
                    btn.style.pointerEvents = 'auto';
                  }
                } else if (btn && cardTierLevel > userTierLevel) {
                  btn.classList.add('upgrade');
                  btn.setAttribute('data-original-text', btn.textContent);
                  btn.textContent = 'Upgrade';
                } else if (btn && cardTierLevel < userTierLevel) {
                  btn.classList.add('downgrade');
                  btn.setAttribute('data-original-text', btn.textContent);
                  btn.textContent = 'Downgrade';
                }
              });
              
              console.log('Highlighted tier:', userTier);
            } else {
              console.log('User is admin - no tier highlighting');
            }
          } catch (error) {
            console.error('Error highlighting tier:', error);
          }
        } else {
          window.currentCurrency = 'USD';
          window.lastSavedCurrency = 'USD';
          if (currencySelect) {
            currencySelect.value = 'USD';
          }
          
          // Remove highlighting when logged out
          document.querySelectorAll('.pricing-card').forEach(card => {
            card.classList.remove('current-tier');
            const btn = card.querySelector('.btn');
            if (btn) {
              btn.classList.remove('upgrade', 'downgrade');
              btn.style.pointerEvents = 'auto';
              btn.style.opacity = '1';
              btn.style.cursor = 'pointer';
            }
          });
          
          // Re-initialize button URLs
          updatePricingDisplay();
        }
        updateSaveButton();
      });
    });

    // Hide loading overlay when page is fully loaded
    window.addEventListener('load', function() {
      const loadingOverlay = document.getElementById('loadingOverlay');
      if (loadingOverlay) {
        loadingOverlay.style.opacity = '0';
        setTimeout(() => {
          loadingOverlay.style.display = 'none';
        }, 30);
      }
    });
  </script>
</body>
</html>
